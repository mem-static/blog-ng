<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.3"/><meta name="description" content="1. 数据传送指令 1.1.1. 赋值指令   可以将 src 的值赋值给 dest，需要注意的是： 两个操作数不能同时为内存变量 两个操作数必须等宽 不能把常数或段寄存器赋值给段寄存器 不允许对 CS 进行赋值 不能用  指令引用寄存器 IP 及 FL。 1.1.2. 堆栈指令 、 指令，参见 [[…" data-gatsby-head="true"/><meta property="og:title" content="8086指令系统" data-gatsby-head="true"/><meta property="og:description" content="1. 数据传送指令 1.1.1. 赋值指令   可以将 src 的值赋值给 dest，需要注意的是： 两个操作数不能同时为内存变量 两个操作数必须等宽 不能把常数或段寄存器赋值给段寄存器 不允许对 CS 进行赋值 不能用  指令引用寄存器 IP 及 FL。 1.1.2. 堆栈指令 、 指令，参见 [[…" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta name="twitter:card" content="summary" data-gatsby-head="true"/><meta name="twitter:creator" content="memset0c" data-gatsby-head="true"/><meta name="twitter:title" content="8086指令系统" data-gatsby-head="true"/><meta name="twitter:description" content="1. 数据传送指令 1.1.1. 赋值指令   可以将 src 的值赋值给 dest，需要注意的是： 两个操作数不能同时为内存变量 两个操作数必须等宽 不能把常数或段寄存器赋值给段寄存器 不允许对 CS 进行赋值 不能用  指令引用寄存器 IP 及 FL。 1.1.2. 堆栈指令 、 指令，参见 [[…" data-gatsby-head="true"/><style data-href="/styles.a1864114d04d83f3c213.css" data-identity="gatsby-global-css">.fade-enter{opacity:0!important}.fade-enter-active{transition:opacity .2s}.fade-enter-active,.fade-enter-done,.fade-exit{opacity:1!important}.fade-exit-active{opacity:0!important;transition:opacity .2s}.appbar-float-enter{top:-68px!important}.appbar-float-enter-active{top:0!important;transition:top .5s}.appbar-float-enter-done{top:0!important}.appbar-animation-basic{opacity:0;transition:opacity .5s}.appbar-animation-fade-in{opacity:1}html{overflow:hidden}::selection{background:rgba(178,143,206,.2);color:inherit}.typography .math.math-display{max-width:100%}.typography pre[class*=language-]{font-size:.92em}.typography pre[class*=language-] .language-css .token.string,.typography pre[class*=language-] .style .token.string,.typography pre[class*=language-] .token.entity,.typography pre[class*=language-] .token.operator,.typography pre[class*=language-] .token.url{background-color:inherit}.typography span.image-alt{color:#a0a0a0;display:block;font-size:.9em;margin-bottom:.8em;margin-top:.8em;text-align:center;width:100%}.typography a{color:#19857b;text-decoration:underline;text-underline-offset:.2rem}.typography img{background-color:#fff;border-style:none;display:block;margin-left:auto;margin-right:auto;max-width:98%}.typography details,.typography figcaption,.typography figure{display:block}.typography summary{display:list-item}.typography mark{background-color:#fff8c5;color:#1f2328}.typography small{font-size:90%}.typography sub,.typography sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.typography sub{bottom:-.25em}.typography sup{top:-.5em}.typography code,.typography kbd,.typography pre,.typography samp{font-family:monospace;font-size:1em}.typography figure{margin:1em 40px}.typography hr{background:transparent;background-color:#d0d7de;border:0;box-sizing:content-box;height:.25em;margin:24px 0;overflow:hidden;padding:0}.typography hr:after,.typography hr:before{content:"";display:table}.typography hr:after{clear:both}.typography table{border-collapse:collapse;border-spacing:0;display:block;margin:1em auto;max-width:100%;overflow:auto;width:-webkit-max-content;width:max-content}.typography td,.typography th{padding:0}.typography table th{font-weight:600}.typography table td,.typography table th{border:1px solid #d0d7de;padding:6px 13px}.typography table td>:last-child{margin-bottom:0}.typography table tr{background-color:#fff;border-top:1px solid #d8dee4}.typography table tr:nth-child(2n){background-color:#f6f8fa}.typography details summary{cursor:pointer}.typography blockquote{border-left:.25em solid #d0d7de;color:#656d76;margin:0;padding:0 1em}.typography blockquote>:first-child{margin-top:0}.typography blockquote>:last-child{margin-bottom:0}code[class*=language-],pre[class*=language-]{background:#fafafa;color:#383a42;direction:ltr;font-family:Fira Code,Fira Mono,Menlo,Consolas,DejaVu Sans Mono,monospace;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:2;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection{background:#e5e5e6;color:inherit}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.2em .3em;white-space:normal}.token.cdata,.token.comment,.token.prolog{color:#a0a1a7}.token.doctype,.token.entity,.token.punctuation{color:#383a42}.token.atrule,.token.attr-name,.token.boolean,.token.class-name,.token.constant,.token.number{color:#b76b01}.token.keyword{color:#a626a4}.token.deleted,.token.important,.token.property,.token.symbol,.token.tag{color:#e45649}.token.attr-value,.token.attr-value>.token.punctuation,.token.builtin,.token.char,.token.inserted,.token.regex,.token.selector,.token.string{color:#50a14f}.token.function,.token.operator,.token.variable{color:#4078f2}.token.url{color:#0184bc}.token.attr-value>.token.punctuation.attr-equals,.token.special-attr>.token.attr-value>.token.value.css{color:#383a42}.language-css .token.selector{color:#e45649}.language-css .token.property{color:#383a42}.language-css .token.function,.language-css .token.url>.token.function{color:#0184bc}.language-css .token.url>.token.string.url{color:#50a14f}.language-css .token.atrule .token.rule,.language-css .token.important,.language-javascript .token.operator{color:#a626a4}.language-javascript .token.template-string>.token.interpolation>.token.interpolation-punctuation.punctuation{color:#ca1243}.language-json .token.operator{color:#383a42}.language-json .token.null.keyword{color:#b76b01}.language-markdown .token.url,.language-markdown .token.url-reference.url>.token.string,.language-markdown .token.url>.token.operator{color:#383a42}.language-markdown .token.url>.token.content{color:#4078f2}.language-markdown .token.url-reference.url,.language-markdown .token.url>.token.url{color:#0184bc}.language-markdown .token.blockquote.punctuation,.language-markdown .token.hr.punctuation{color:#a0a1a7;font-style:italic}.language-markdown .token.code-snippet{color:#50a14f}.language-markdown .token.bold .token.content{color:#b76b01}.language-markdown .token.italic .token.content{color:#a626a4}.language-markdown .token.list.punctuation,.language-markdown .token.strike .token.content,.language-markdown .token.strike .token.punctuation,.language-markdown .token.title.important>.token.punctuation{color:#e45649}.token.bold{font-weight:700}.token.comment,.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.8}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:rgba(56,58,66,.2)}div.code-toolbar>.toolbar.toolbar>.toolbar-item{margin-right:.4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span{background:#e5e5e6;border-radius:.3em;color:#696c77;padding:.1em .4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{background:#c6c7c7;color:#383a42}.line-highlight.line-highlight{background:rgba(56,58,66,.05)}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background:#e5e5e6;border-radius:.3em;box-shadow:0 2px 0 0 rgba(0,0,0,.2);color:#383a42;padding:.1em .6em}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:rgba(56,58,66,.05)}.command-line .command-line-prompt,.line-numbers.line-numbers .line-numbers-rows{border-right-color:rgba(56,58,66,.2)}.command-line .command-line-prompt>span:before,.line-numbers .line-numbers-rows>span:before{color:#9d9d9f}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:#e45649}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:#50a14f}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:#4078f2}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:#a626a4}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(255,82,102,.15)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(25,255,91,.15)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::selection{background-color:rgba(56,224,98,.25)}.prism-previewer-gradient.prism-previewer-gradient div,.prism-previewer.prism-previewer:before{border-color:hsl(0,0,95%)}.prism-previewer-color.prism-previewer-color:before,.prism-previewer-easing.prism-previewer-easing:before,.prism-previewer-gradient.prism-previewer-gradient div{border-radius:.3em}.prism-previewer.prism-previewer:after{border-top-color:hsl(0,0,95%)}.prism-previewer-flipped.prism-previewer-flipped.after{border-bottom-color:hsl(0,0,95%)}.prism-previewer-angle.prism-previewer-angle:before,.prism-previewer-easing.prism-previewer-easing,.prism-previewer-time.prism-previewer-time:before{background:#fff}.prism-previewer-angle.prism-previewer-angle circle,.prism-previewer-time.prism-previewer-time circle{stroke:#383a42;stroke-opacity:1}.prism-previewer-easing.prism-previewer-easing circle,.prism-previewer-easing.prism-previewer-easing line,.prism-previewer-easing.prism-previewer-easing path{stroke:#383a42}.prism-previewer-easing.prism-previewer-easing circle{fill:transparent}@media screen and (max-width:599.5px){.article-module--article-card--a261e{border-radius:0!important;margin-left:-16px;margin-right:-16px;margin-top:-32px}}.article-module--article-title--12b60{color:#404040;font-size:1.2em;font-weight:700;margin-top:.5em}@media screen and (min-width:1200px){.article-module--article-title--12b60{font-size:1.8em}}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=887b7f363764bf61c53de657200e0aee" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=887b7f363764bf61c53de657200e0aee"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=887b7f363764bf61c53de657200e0aee"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=887b7f363764bf61c53de657200e0aee"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=887b7f363764bf61c53de657200e0aee"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=887b7f363764bf61c53de657200e0aee"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=887b7f363764bf61c53de657200e0aee"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=887b7f363764bf61c53de657200e0aee"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=887b7f363764bf61c53de657200e0aee"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" crossorigin="anonymous"/><title data-gatsby-head="true">8086指令系统 - mem 的小站</title><style data-gatsby-head="true"></style></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="opacity:0"><style data-emotion="css 1oifrf6">.css-1oifrf6{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;margin-top:32px;margin-bottom:32px;}@media (min-width:600px){.css-1oifrf6{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1oifrf6{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-1oifrf6"><article itemscope="" itemType="http://schema.org/Article"><style data-emotion="css isbt42">.css-isbt42{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin-top:-16px;width:calc(100% + 16px);margin-left:-16px;}.css-isbt42>.MuiGrid-item{padding-top:16px;}.css-isbt42>.MuiGrid-item{padding-left:16px;}</style><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-isbt42"><style data-emotion="css 1hjwhii">.css-1hjwhii{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}@media (min-width:600px){.css-1hjwhii{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-1hjwhii{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:1200px){.css-1hjwhii{-webkit-flex-basis:75%;-ms-flex-preferred-size:75%;flex-basis:75%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:75%;}}@media (min-width:1536px){.css-1hjwhii{-webkit-flex-basis:75%;-ms-flex-preferred-size:75%;flex-basis:75%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:75%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-lg-9 css-1hjwhii"><style data-emotion="css i6bazn">.css-i6bazn{overflow:hidden;}</style><style data-emotion="css s18byi">.css-s18byi{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;box-shadow:0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);overflow:hidden;}</style><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root article-module--article-card--a261e css-s18byi"><style data-emotion="css 3rktj0">.css-3rktj0{padding:16px;}.css-3rktj0:last-child{padding-bottom:24px;}@media (min-width:900px){.css-3rktj0{padding:24px;}}</style><div class="MuiCardContent-root css-3rktj0"><style data-emotion="css lkg31h">.css-lkg31h{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1.5rem;line-height:1.334;letter-spacing:0em;text-indent:0;}</style><div class="MuiTypography-root MuiTypography-h5 article-module--article-title--12b60 css-lkg31h">8086指令系统</div><style data-emotion="css 9l3uo3">.css-9l3uo3{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}</style><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3"><section class="typography" itemProp="articleBody"><h2>1. 数据传送指令</h2>
<h4>1.1.1. 赋值指令 <code class="language-text">mov</code></h4>
<p><code class="language-text">mov dest, src</code> 可以将 src 的值赋值给 dest，需要注意的是：</p>
<ul>
<li>两个操作数不能同时为内存变量</li>
<li>两个操作数必须等宽</li>
<li>不能把常数或段寄存器赋值给段寄存器</li>
<li>不允许对 CS 进行赋值</li>
<li>不能用 <code class="language-text">mov</code> 指令引用寄存器 IP 及 FL。</li>
</ul>
<h4>1.1.2. 堆栈指令</h4>
<p><code class="language-text">push</code>、<code class="language-text">pop</code> 指令，参见 [[5. 汇编语言进阶]]。</p>
<h4>1.1.3. 交换指令 <code class="language-text">xchg</code></h4>
<p><code class="language-text">xchg op1, op2</code> 可以实现：1. 两个寄存器；2. 一个寄存器和一个变量之间的值的<strong>交换</strong>操作。</p>
<h3>1.2. 输入输出指令</h3>
<p><code class="language-text">in</code>、<code class="language-text">out</code> 指令，参见 [[3. CPU、内存和端口]]。</p>
<h3>1.3. 地址传送指令</h3>
<h4>1.3.1. <code class="language-text">lea</code></h4>
<p><code class="language-text">lea dest:reg src:mem</code>：load effective address，即取变量 src 的<strong>偏移地址</strong>存储到寄存器 dest 中。</p>
<div class="gatsby-highlight" data-language="asm"><pre class="language-asm"><code class="language-asm">lea dx, ds:[1000h]    ; 等价于 mov dx, 1000h
lea dx, [abc]         ; 等价于 mov dx, offset abc
lea dx, ds:[bx+si+3]  ; 令dx=bx+si+3，无法直接用mov实现</code></pre></div>
<h4>1.3.2. <code class="language-text">lds</code>、<code class="language-text">les</code> 等</h4>
<p><code class="language-text">lds dest:reg, src:mem32</code>、<code class="language-text">les dest:reg, src:mem32</code> 可以取出<strong>保存在变量 src 中的远地址</strong>，且将其中的段地址部分赋值给 DS（<code class="language-text">lds</code> 的行为）或 ES（<code class="language-text">les</code> 的行为），偏移地址部分赋值给 dest 寄存器。等效于如下汇编：</p>
<div class="gatsby-highlight" data-language="asm"><pre class="language-asm"><code class="language-asm">mov dest, word ptr [src]     ; 这里dest是一个寄存器名
mov ds, word ptr[src+2]      ; 如果是les指令这里就是es</code></pre></div>
<h3>1.4. 标志寄存器传送指令</h3>
<p><code class="language-text">pushf</code>、<code class="language-text">popf</code> 指令，参见 [[3. CPU、内存和端口]]。</p>
<h2>2. 转换指令</h2>
<h3>2.1. 扩充指令</h3>
<p>详见 [[2. 数据的表示与运算]]。</p>
<h3>2.2. 换码指令 <code class="language-text">xlat</code></h3>
<p><code class="language-text">xlat</code>（<strong>没有参数</strong>）会把 byte ptr DS:[BX:AL] 的值赋值给 AL，必须要在操作前让 DS:BX 指向表，AL 指向需要的下标。</p>
<blockquote>
<p>[!info]- 利用 xlat 指令将 32 位整数化为 16 进制输出</p>
<div class="gatsby-highlight" data-language="asm"><pre class="language-asm"><code class="language-asm">.386
data segment use16
t db &quot;0123456789ABCDEF&quot;
x dd 2147483647
data ends

code segment use16
assume cs:code, ds:data
main:
  mov ax, data      ;\
  mov ds, ax        ; | ds:bx-&gt;t[0]
  mov bx, offset t  ;/
  mov cx, 8
  mov eax, [x]
next:
  rol eax, 4
  push eax
  and eax, 0Fh
  xlat
  mov ah, 2
  mov dl, al
  int 21h
  pop eax
  sub cx, 1
  jnz next
  mov ah, 4Ch
  int 21h
code ends
end main</code></pre></div>
</blockquote>
<h2>3. 算术运算指令</h2>
<p>详见 [[2. 数据的表示与运算]]。</p>
<h2>4. 十进制调整指令</h2>
<p>咕咕咕。</p>
<h2>5. 逻辑运算指令和移位指令</h2>
<p>详见 [[2. 数据的表示与运算]]。</p>
<h2>6. 字符串操作指令</h2>
<p>详见 [[2. 数据的表示与运算]]。</p>
<h2>7. 控制转移指令</h2>
<h3>7.1. 无条件跳转指令 <code class="language-text">jmp</code></h3>
<p>根据跳转距离的远近，可以将 <code class="language-text">jmp</code> 分成三类：</p>
<ul>
<li>短跳（short jump）：跳转距离用一个字节表示</li>
<li>近跳（near jump）：跳转距离或目标地址用一个字表示</li>
<li>远跳（far jump）：目标地址用一个原指针表示</li>
</ul>
<h4>7.1.1. <code class="language-text">jmp short dest</code></h4>
<p>短跳的机器码由 2 个字节构成 <code class="language-text">0EBh, idata8</code>。其中 <code class="language-text">idata8</code> 是一个 8 位整数，表示短跳的跳转距离。在编写汇编程序的过程中，我们可以使用标号代替，编译器会自动计算出标号与下条指令之间的距离，公式如下：</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>idata8</mtext><mo>=</mo><mtext>标号</mtext><mo>−</mo><mo stretchy="false">(</mo><mi mathvariant="normal">$</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{idata8} = \text{标号} - (\$ + 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">idata8</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord cjk_fallback">标号</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">$</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></div>
<p>这里 <code class="language-text">$</code> 表示的是短跳指令自身的偏移地址，故 <code class="language-text">$+2</code> 实际上就是下条指令的偏移地址。</p>
<h4>7.1.2. <code class="language-text">jmp near ptr dest</code></h4>
<p>近跳的机器码由 3 个字节构成 <code class="language-text">0E9h, idata16_ls, idata16_hs</code>。其中 <code class="language-text">idata16_ls</code> 和 <code class="language-text">idata16_hs</code> 分别是 <code class="language-text">idata16</code> 的低 8 位和高 8 位，同样的 <code class="language-text">idata16</code> 就是近跳的目标地址和<strong>下条指令</strong>的偏移地址之差，计算公式如下：</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>idata16</mtext><mo>=</mo><mtext>标号</mtext><mo>−</mo><mo stretchy="false">(</mo><mi mathvariant="normal">$</mi><mo>+</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{idata16} = \text{标号} - (\$ + 3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">idata16</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord text"><span class="mord cjk_fallback">标号</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">$</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span></div>
<p>由于近跳和短跳相比多了一个字节，故下条指令的地址变成了 <code class="language-text">$+3</code>。在使用近跳指令时，<code class="language-text">near ptr</code> <strong>可以省略</strong>不写。</p>
<p>近跳指令还支持直接给定目标地址的偏移地址，格式为 <code class="language-text">jmp reg16|mem16</code>，相当于直接给 IP 寄存器赋值。注意这里如果是 <code class="language-text">mem16</code> 的话别忘了用 <code class="language-text">word ptr</code> 修饰宽度。</p>
<h4>7.1.3. <code class="language-text">jmp far ptr dest</code></h4>
<p>远跳的字节码有 5 个字节构成，<code class="language-text">0EAh, idata32_l16, idata32_h16</code>。其中 <code class="language-text">idata32</code> 是一个 32 位的远指针，表示跳转的目标地址，其端地址就是 <code class="language-text">idata32_h16</code>，偏移地址就是 <code class="language-text">idata32_l16</code>。注意这里的地址仍然是<strong>小端存储</strong>。例如：机器码 <code class="language-text">0EAh, 78h, 56h, 34h, 12h</code> 对应的目标地址是 1234:5678。</p>
<p>当远跳指令<strong>向后引用</strong>（引用的变量或标号在当前语句的上方）一个不在同一段内的<strong>远标号</strong>时，<code class="language-text">far ptr</code> <strong>可以省略</strong>不写；否则必须写出 <code class="language-text">far ptr</code> 不然 CPU 会报错：</p>
<ul>
<li>当引用了一个不在同一段的<strong>近标号</strong>而不写明 <code class="language-text">far ptr</code> 时会报“Near JMP/CALL to different CS”错误</li>
<li>当<strong>向前引用</strong>（引用的变量或标号在当前语句下方）了一个不在同一段内的原标号而不写明 <code class="language-text">far ptr</code> 时会报“Forward needs override or FAR”错误。（不过这一问题可以通过用 <code class="language-text">tasm /m2</code> 代替 <code class="language-text">masm</code> 编译来解决）</li>
</ul>
<p>远跳指令可以跳转到远标号（定义方法：<code class="language-text">标号名 label far</code>），也可以直接给定目标地址，相当于同时修改了 CS 和 IP 寄存器的值。示例代码如下：</p>
<div class="gatsby-highlight" data-language="asm"><pre class="language-asm"><code class="language-asm">mov word ptr es:[di], 5678h
mov word ptr es:[di+4], 1234h
jmp dword ptr es:[di]  ; 将会跳转到1234:5678</code></pre></div>
<h3>7.2. 条件跳转指令 <code class="language-text">jcc</code></h3>
<ul>
<li>关于 <code class="language-text">test</code> 指令（相当于只影响寄存器的 <code class="language-text">and</code> 指令）的 JCC 指令有 <code class="language-text">jz</code> 和 <code class="language-text">jnz</code>。通过对两操作数执行 <code class="language-text">test</code> 指令，如果他们的逻辑与的值为 0，ZF 就会被置 1，这时可用 <code class="language-text">jz</code> 指令跳转。</li>
<li>关于 <code class="language-text">cmp</code> 指令（相当于只影响寄存器的 <code class="language-text">sub</code> 指令）的 JCC 指令有 <code class="language-text">je</code>、<code class="language-text">ja</code> 、<code class="language-text">jb</code>、<code class="language-text">jl</code>、<code class="language-text">jg</code> 、<code class="language-text">jae</code>、<code class="language-text">jbe</code>、<code class="language-text">jle</code>、<code class="language-text">jge</code> 等。</li>
<li>进一步地、关于标志寄存器的 JCC 指令有 <code class="language-text">jc</code>、<code class="language-text">jnc</code>、<code class="language-text">jz</code>、<code class="language-text">jnz</code>、<code class="language-text">js</code>、<code class="language-text">jns</code>、<code class="language-text">jo</code>、<code class="language-text">jno</code>、<code class="language-text">jp</code>、<code class="language-text">jnp</code> 十个，分别对应相应的标志寄存器。</li>
<li>特别地，还有 <code class="language-text">jcxz</code> 和 <code class="language-text">jexcz</code> 指令，检查 CX 或 ECX 寄存器是否为 0，是的话则跳转，往往和 <code class="language-text">loop</code> 指令配合使用。</li>
</ul>
<p>注意 JCC 指令的跳转距离为 1 字节，也就是说跳转的目标地址和下条指令的偏移地址的之间的距离必须在 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>128</mn><mo separator="true">,</mo><mn>127</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-128,127]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">128</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">127</span><span class="mclose">]</span></span></span></span></span> 的范围内。</p>
<h3>7.3. 循环指令 <code class="language-text">loop</code></h3>
<p><code class="language-text">loop dest</code> 指令会<strong>先</strong>将 CX 寄存器的值自减，再检查 CX 是否不等于零，如果是的话则跳转到 <code class="language-text">dest</code> 标号处。在不能确定 CX 的初值非零的情况下，最好先用 <code class="language-text">jcxz</code> 指令判断，避免程序陷入“死循环”中。</p>
<p><code class="language-text">loop</code> 指令与 JCC 指令一样，跳转距离为 1 字节。</p>
<blockquote>
<p>[!info] 例：求 1+2+3 的和</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">  mov ax, 0
  mov cx, 3
next:
  add ax, cx
  loop next</code></pre></div>
<p>这里的 <code class="language-text">loop next</code> 等价于 <code class="language-text">dec cx</code> 和 <code class="language-text">jnz next</code> 这两条指令。</p>
</blockquote>
<h3>7.4. 子程序调用与返回指令 <code class="language-text">call</code>、<code class="language-text">ret</code> 、<code class="language-text">retf</code></h3>
<p>详见 [[5. 汇编语言进阶]] 的函数部分。</p>
<h3>7.5. 中断和中断返回指令 <code class="language-text">int</code>、<code class="language-text">int3</code>、<code class="language-text">into</code>、<code class="language-text">iret</code></h3>
<p>详见 [[5. 汇编语言进阶]] 的中断程序设计部分。</p></section></p></div></div></div><style data-emotion="css ja4s3e">.css-ja4s3e{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}@media (min-width:600px){.css-ja4s3e{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-ja4s3e{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:1200px){.css-ja4s3e{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:25%;}}@media (min-width:1536px){.css-ja4s3e{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:25%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-lg-3 css-ja4s3e"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-s18byi"><style data-emotion="css 1qw96cp">.css-1qw96cp{padding:16px;}.css-1qw96cp:last-child{padding-bottom:24px;}</style><div class="MuiCardContent-root css-1qw96cp"><p>这里是还没做好的侧边栏</p><p>这里是还没做好的侧边栏</p><p>这里是还没做好的侧边栏</p></div></div></div></div></article></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/course/custom/fasm/note/4/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-bcb8ab2b85bad38646a8.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-e1b51a424c07b1542c0d.js\"],\"component---src-pages-about-js\":[\"/component---src-pages-about-js-09e438f4b830a635b069.js\"],\"component---src-templates-doc-js\":[\"/component---src-templates-doc-js-e31805ab2cb0f3c309da.js\"],\"component---src-templates-post-js\":[\"/component---src-templates-post-js-1f551025f67e682f09f3.js\"],\"component---src-templates-post-list-js\":[\"/component---src-templates-post-list-js-a3f708079d6339d2d602.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="690f6802b56d8c76c81a";</script><script src="/webpack-runtime-36046c81364c0b4c46d8.js" async></script><script src="/framework-e3106602daf58be8a08f.js" async></script><script src="/app-bcb8ab2b85bad38646a8.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>