{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/contest/20200810b/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p>有 $n$ 个人要从 $(0,a_i)$ 走到 $(i,0)$，你需要规划他们的路径使得两两不交。问方案数。</p>\n<p>$a_i &#x3C; a_{i+1},\\ n \\leq 5 \\times 10^5,\\ a_i \\leq 10^6$。</p>\n</blockquote>\n<!--more-->\n<h2>题解</h2>\n<p>需要统计 DAG 上的不交路径问题，我们考虑 LGV 引理。由于这是网格图，所有路径起点和终点的位置关系是确定的，即我们可以直接确定右式的\t系数。</p>\n<blockquote>\n<p>LGV 引理：</p>\n<p>$$\nM = \\begin{bmatrix}e(A_1,B_1)&#x26;e(A_1,B_2)&#x26;\\cdots&#x26;e(A_1,B_n)\\\ne(A_2,B_1)&#x26;e(A_2,B_2)&#x26;\\cdots&#x26;e(A_2,B_n)\\\n\\vdots&#x26;\\vdots&#x26;\\ddots&#x26;\\vdots\\\ne(A_n,B_1)&#x26;e(A_n,B_2)&#x26;\\cdots&#x26;e(A_n,B_n)\\end{bmatrix}\n$$</p>\n<p>$$\n\\det(M)=\\sum\\limits_{S:A\\rightarrow B}(-1)^{N(\\sigma(S))}\\prod\\limits_{i=1}^n \\omega(S_i)\n$$</p>\n</blockquote>\n<p>对于这个问题 $M_{i,j}$ 可以表示为</p>\n<p>$$\nM_{i,j}=\\binom{a_i+j}{j}=\\frac{(a_i+1)^{\\overline{j}}}{j!}\n$$</p>\n<p>现在的问题在于求 $M$ 的行列式，把每一列里的 $\\dfrac{1}{j!}$ 提出来。</p>\n<p>考虑每一行都是同一个多项式（$(x+1)^{\\overline{j}}$），不妨消成 $(x+1)^j$。</p>\n<p>这样问题就变为了对于矩阵：</p>\n<p>$$\nM' = \\begin{bmatrix}\n(a_1+1)&#x26;(a_1+1)^2&#x26;\\cdots&#x26;(a_1+1)^n\\\n(a_2+1)&#x26;(a_2+1)^2&#x26;\\cdots&#x26;(a_2+1)^n\\\n\\vdots&#x26;\\vdots&#x26;\\ddots&#x26;\\vdots\\\n(a_n+1)&#x26;(a_n+1)^n&#x26;\\cdots&#x26;(a_n+1)^n\n\\end{bmatrix}\n$$</p>\n<p>这是范德蒙德矩阵，行列式为：</p>\n<p>$$\n\\det(M') = \\prod_{1\\leq i&#x3C; j\\leq n}((a_j+1)-(a_i+1))\n= \\prod_{1\\leq i&#x3C; j\\leq n}(a_j-a_i)\n$$</p>\n<p>做一次 $2^{21}$ 长度的卷积即可计算。</p>","frontmatter":{"date":"November 24, 2020","title":"「校内模拟20200810B」分身","cover":"/cover/32.webp"}}},"pageContext":{"id":"28bf8238-afa7-5876-be0f-a76f85d910b2","slug":"blog/contest/20200810b"}},"staticQueryHashes":[],"slicesMap":{}}