{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/math/approximants/","result":{"data":{"markdownRemark":{"html":"<h2>切线放缩</h2>\n<p>高中阶段有一类常用的不等式：\n$$\n\\begin{aligned}\ne^x\\ge x+1 &#x26;\\Leftrightarrow \\ln(x+1) \\le x \\\n\\ln x\\le x-1 &#x26;\\Leftrightarrow e^x\\ge ex\n\\end{aligned}\n$$\n这些不等式都是由原式在某点的切线方程得到的，切线方程和原函数的在该点的值和一阶导都相同。通过泰勒展开，我们可以把这种思想从一阶推广到 $n$ 阶甚至任意阶。</p>\n<h2>泰勒展开</h2>\n<p>对于多项式 $f(x)$，我们定义 $T_n(x)=\\sum\\limits_{i=0}^n\\dfrac{f^{(i)}(x_0)(x-x_0)^i}{i!}$ 为其 $n$ 阶泰勒级数（Taylor Series）。$T_n(x)$ 与原函数在 $x_0$ 处有相同的 $n$ 阶导数，即对于任意 $k\\in [0,n]$，$f^{(k)}(x_0) = T_n^{(k)}(x_0)$。特别地，当 $x_0=0$ 时，该级数又称作原函数的麦克劳林级数（Maclaurin Series）。</p>\n<h4>应用：得到常用不等式</h4>\n<p>对一些函数进行泰勒展开，我们可以得到一些常用的不等式，如：</p>\n<p>由 $e^x=1+x+\\dfrac{x^2}{2!}+\\dfrac{x^3}{3!}+\\dfrac{x^4}{4!}+\\cdots$ 我们可以得到 $e^x\\ge x+1,\\quad e^x\\ge \\dfrac{x^2}{2} +x+1$ 等不等式。</p>\n<p>类似的，由 $\\ln (x+1)=x-\\dfrac{x^2}{2}+\\dfrac{x^3}{3}-\\cdots$ 可以得到 $\\ln(x+1)\\ge x-\\dfrac{x^2}2(x\\ge 0)$，$\\ln(x+1)\\le x-\\dfrac{x^2}2(x\\le 0)$ 等，注意在 $0$ 的两侧不等号的方向是相反的。</p>\n<p>简单三角函数也可通过泰勒展开得到一些常用的不等式，由 $\\sin x = x-\\dfrac{x^3}{6}+\\dfrac{x^5}{120}+\\cdots$ 可以得到 $\\sin x \\leq x(x\\ge 0)$，$\\sin x\\geq x(x\\le0)$，$\\sin x \\ge x - \\dfrac {x^3}{6}(x\\ge 0)$，$\\sin x\\ge x-\\dfrac{x^3}{6}(x\\le 0)$  等。</p>\n<p>类似的，由 $\\cos x = 1-\\dfrac{x^2}{2}+\\dfrac{x^4}{24}-\\cdots$ 可以得到 $\\cos x \\ge 1 - \\dfrac{x^2}2$ 等。</p>\n<p>这种方法并不总能成功，我们需要另外验证不等式成立的范围。</p>\n<h2>帕德逼近</h2>\n<p>帕德逼近与泰勒展开的想法类似，对于函数 $f(x)$，我们构造一个分式 $R_{n,m}(x)=\\dfrac{p_n(x)}{q_m(x)}$，其中 $p_n(x),;q_m(x)$ 分别为 $n$、$m$ 次多项式。我们需要找到这样的分式，满足在 $x_0$ 处与原函数有相同的 $n+m$ 阶导数，即对于任意 $k\\in [0,n+m]$，$f^{(k)}(x_0) = R_{n,m}^{(n+m)}(x_0)$。这样的 $R_{n,m}(x)$ 就是原函数在 $x_0$ 处的 $[n,m]$ 阶帕德逼近。</p>\n<p>常见函数的帕德逼近参见下表，由代码 <a href=\"https://github.com/memset0/naive-toys/blob/master/pade-approximants/pade.py\">pade.py</a> 得到。</p>\n<table>\n<thead>\n<tr>\n<th>$e^x$</th>\n<th>$m=0$</th>\n<th>$m=1$</th>\n<th>$m=2$</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>$n=0$</td>\n<td>$1$</td>\n<td>$\\dfrac{x+1}{1}$<small>（恒小于）</small></td>\n<td>$\\dfrac{x^2+2x+2}{2}$</td>\n</tr>\n<tr>\n<td>$n=1$</td>\n<td>$\\dfrac{1}{-x+1}$<small>（恒大于）</small></td>\n<td>$\\dfrac{x+2}{-x+2}$</td>\n<td>$\\dfrac{x^2+4x+6}{-2x+6}$<small>（恒大于）</small></td>\n</tr>\n<tr>\n<td>$n=2$</td>\n<td>$\\dfrac{2}{x^2-2x+2}$</td>\n<td>$\\dfrac{2x+6}{x^2-4x+6}$<small>（恒小于）</small></td>\n<td>$\\dfrac{x^2+6x+12}{x^2-6x+12}$</td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th>$\\ln(x+1)$</th>\n<th>$m=1$</th>\n<th>$m=2$</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>$n=0$</td>\n<td>$x$<small>（恒小于）</small></td>\n<td>$\\dfrac{2x-x^2}{2}$</td>\n</tr>\n<tr>\n<td>$n=1$</td>\n<td>$\\dfrac{2x}{x+2}$</td>\n<td>$\\dfrac{x^2+6x}{4x+6}$<small>（恒大于）</small></td>\n</tr>\n<tr>\n<td>$n=2$</td>\n<td>$\\dfrac{2x}{x+2}$<small>（恒大于）</small></td>\n<td>$\\dfrac{3x^2+6x}{x^2+6x+6}$</td>\n</tr>\n</tbody>\n</table>\n<h4>应用：一类“比大小”问题</h4>\n<blockquote>\n<p><strong>2022 年新高考全国 I 卷 7.</strong> 设 $a=0.1e^{0.1}$，$b=\\dfrac 19$，$c=-\\ln 0.9$，则（$\\quad$）</p>\n<p>A. $a&#x3C;b&#x3C;c\\quad$ B. $c&#x3C;b&#x3C;a\\quad$ C. $c&#x3C;a&#x3C;b\\quad$ D.$a&#x3C;c&#x3C;b\\quad$</p>\n</blockquote>\n<p>一般的做法肯定是构造函数，但这里我们试图用 $[2,2]$ 阶帕德逼近的结果代入一下：</p>\n<p>$$\n\\left{\\begin{aligned}\n10\\cdot a &#x26;= \\frac{0.01+0.6+12}{0.01-0.6+12} = \\frac{12.61}{11.41} \\\n10\\cdot b &#x26;= \\frac{10}{9} \\\n10\\cdot c &#x26;= \\frac{0.6-0.03}{0.01-0.6+6} = \\frac{5.7}{5.41} \\\n\\end{aligned}\\right.\n$$</p>\n<p>先比较简单的两个，发现 $a&#x3C;b$ 且 $c&#x3C;b$，还需要一个三位数乘四位数的乘法就可以得到答案，相比直接构造还是能省下不少时间。</p>\n<p>下图由 Geogebra 绘制，可以发现我们的精度在 $x=0.1$ 处可谓绰绰有余。</p>\n<p><img src=\"https://static.memset0.cn/img/v5/2022/09/04/63148d36e50f9.png\" alt=\"\"></p>\n<h4>应用：手算 $\\ln(x)$ 的值</h4>\n<p>将 $x$ 拆分成 $x=2\\cdot \\dfrac{c_1+1}{c_1}\\cdot \\dfrac{c_2+1}{c_2}\\cdot \\dfrac{c_3+1}{c_3} \\cdots$ 的形式，然后代入 $\\ln 2=0.693$，$\\ln\\left(\\dfrac{n+1}{n}\\right)\\sim\\dfrac{2}{2n+1}\\quad (n\\ge 3)$ 得近似值。</p>\n<p>例（$\\ln (11) = 2.397895\\ldots$）：</p>\n<p>$$\n\\begin{aligned}\n\\ln 11\n&#x26;= \\ln \\dfrac {11}{10} + \\ln 5 + \\ln 2 \\\n&#x26;= \\ln \\dfrac {11}{10} + \\ln {5}{4} + 3\\ln 2 \\\n&#x26;\\approx \\frac {2}{21} +\\frac {2}{9}+3\\times 0.693 \\approx 2.3964)\n\\end{aligned}\n$$</p>\n<p>注意到 $\\ln\\left(\\dfrac{n+1}{n}\\right)\\sim\\dfrac{2}{2n+1}$ 这一近似实际上就是 $\\ln(x+1)$ 的 $[1,1]$ 阶帕德逼近。</p>\n<p>这种方法一般情况下可精确到 $2$ 至 $3$ 位，$x\\le 1000$ 时最大误差约为 $0.0071$（参考代码：<a href=\"https://github.com/memset0/naive-toys/blob/master/pade-approximants/ln-x.py\">ln-x.py</a>）。比直接使用帕德逼近精度更高，且计算量较小，适合笔头计算。</p>\n<h2>实洛朗级数</h2>\n<p>还没学会。</p>\n<h2>例题</h2>\n<p>在路上了。</p>\n<h2>参考资料</h2>\n<ul>\n<li><a href=\"https://zh.wikipedia.org/wiki/%E6%B3%B0%E5%8B%92%E7%BA%A7%E6%95%B0\">泰勒级数 - Wikipedia</a></li>\n<li><a href=\"https://zh.m.wikipedia.org/zh-hans/%E5%B8%95%E5%BE%B7%E8%BF%91%E4%BC%BC\">帕德近似 - Wikipedia</a></li>\n<li><a href=\"https://numanal.com/pade-approximants/\">帕德逼近 (Padé approximation) - 数值分析大巴</a></li>\n<li><a href=\"https://www.bilibili.com/video/BV1Hr4y1Q7Zf\">三步手撕任意lnx - 火星课堂, bilibili.com</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/92873681\">帕德逼近（Pade’s Approximant) - 玺之, zhihu.com</a></li>\n<li><a href=\"https://www.zhihu.com/question/465913059/answer/1948539534\">帕德近似如何操作？ - 枍倾尘, zhihu.com</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/123329716\">【导数问题】函数逼近的一些方法 - 零号的鬼, zhihu.com</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/339473156\">第二章 : 函数放缩问题●实洛朗级数 - 高考数学呆哥, zhihu.com</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/530933700\">【升级の高中数学／导数】函数逼近的三种方法——泰勒展开、帕德逼近与洛朗级数 - 霜夏, zhihu.com</a></li>\n</ul>\n<style>\n    table { table-layout: fixed !important; }\n    table tr th, table tr td { text-align: center; }\n    table tr td small { display: block; }\n    table tr th:first-child, table tr td:first-child { max-width: 160px !important; }\n</style>","frontmatter":{"date":"July 16, 2022","title":"浅谈高中数学中常用的逼近方法","cover":"/cover/39.jpg"}}},"pageContext":{"id":"a5ff8b86-75f6-55ff-876f-528dcadd354f","slug":"blog/math/approximants"}},"staticQueryHashes":[],"slicesMap":{}}