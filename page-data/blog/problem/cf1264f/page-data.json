{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/problem/cf1264f/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p>对于长度为 $n$ 的递增等差正整数序列 ${a, a+d, a+2d \\ldots a+(n-1)d}$，我们用三元组 $(a,d,n)$ 表示。</p>\n<p>给定递增等差正整数序列 $(a,d,n)$，你需要构造递增等差正整数序列 $(b,e,n)$，满足：</p>\n<ul>\n<li>$b,e &#x3C; 2^{64}$，且是正整数</li>\n<li>对于所有 $0 \\leq i &#x3C; n$，$a+id$ 的十进制表示是 $F_{b+ie}$ 的十进制表示的后 $18$ 位的子串（如果没有 $18$ 位自动补前导零）。其中 $F_i$ 是指斐波那契数列的第 $i$ 项。</li>\n</ul>\n<p>$1 \\leq a+(n-1)d \\leq 10^6$。</p>\n</blockquote>\n<!--more-->\n<h2>题解</h2>\n<p>设 $P = 10^6$，则有 $\\pi(P) \\mid 6P$，尝试得取 $n = 3P$ 是 $\\bmod P$ 意义下的周期。</p>\n<p>则有 $F_{n} \\equiv 0 \\pmod P$，$F_{n+1} \\equiv 1 \\pmod P$。考虑：</p>\n<ul>\n<li>$F_{2n+1} \\equiv F_n^2 + F_{n+1}^2 \\equiv F_{n+1}^2 \\pmod {P^2}$</li>\n<li>$F_{3n+1} \\equiv F_n F_{2n} + F_{n+1} F_{2n+1} \\equiv F_{n+1}^3 \\pmod {P^2}$</li>\n<li>$\\ldots$</li>\n<li>$F_{kn+1} \\equiv F_{n+1}^k \\pmod {P^2}$</li>\n</ul>\n<p>此例中，我们有 $F_{n+1} \\equiv 2 t P + 1 \\pmod P^2$，其中 $t$ 是与 $P$ 互质的整数。</p>\n<p>则 $F_{kn+1} \\equiv F_{n+1}^k \\equiv 2kt P + 1$，取 $k = 5 k' t^{-1}$，则枚举 $1 \\leq k' &#x3C; 10^6$ 即可解决本题。</p>\n<h2>代码（Python）</h2>\n<pre><code class=\"language-py\">def exgcd(a,b):\n    if b==0:\n        return 1,0\n    x,y=exgcd(b,a%b)\n    return y,x-y*(a//b)\ndef inv(a,p):\n    x,y=exgcd(a,p)\n    return (x%p+p)%p\ndef xmul(a,b):\n    c=[[0,0],[0,0]]\n    for i in range(0,2):\n        for j in range(0,2):\n            for k in range(0,2):\n                c[i][j]=(c[i][j]+a[i][k]*b[k][j])%(10**12)\n    return c\ndef xpow(a,b):\n    s=[[1,0],[0,1]]\n    while b:\n        if b%2:\n            s=xmul(s,a)\n        a=xmul(a,a)\n        b//=2\n    return s\ndef fib(n):\n    if n&#x3C;=1:\n        return n\n    return xmul([[1,0],[0,0]],xpow([[1,1],[1,0]],n-1))[0][0]\nif __name__==\"__main__\":\n    t=fib(3*(10**6)+1)//(10**6)\n    u=15*inv(t//2,10**6)\n    n,a,d=map(int,input().split())\n    b=a*u*(10**6)+1\n    e=d*u*(10**6)\n    print(b,e)\n</code></pre>","frontmatter":{"date":"September 17, 2020","title":"「CF1264F」Beautiful Fibonacci Problem","cover":"/cover/35.webp"}}},"pageContext":{"id":"a36f4576-06fd-5aa0-8f57-6876cdcab4a9","slug":"blog/problem/cf1264f"}},"staticQueryHashes":[],"slicesMap":{}}