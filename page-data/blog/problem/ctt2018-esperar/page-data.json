{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/problem/ctt2018-esperar/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p>给定 $n$ 和长度为 $n$ 的数组 ${a_i } <em>{i=1}^n$ ，求满足 $\\forall i \\in [1, n], c_i | b_i, b_i | a_i$ 并且 $\\prod</em>{i=1}^n c_i^2  \\leq \\prod_{i=1}^n b_i$ 的 ${b_i}<em>{i=1}^n$ 和 ${c_i}</em>{i=1}^n$ 的方案数。</p>\n<p>$n \\leq 100,\\ a_i \\leq 10^9$。</p>\n</blockquote>\n<!--more-->\n<p>假设 $B = \\prod_{i=1}^n b_i, C = \\prod_{i=1}^n c_i^2$ ，易证 $C &#x3C; B$ 的方案与 $C > B$ 的方案是相同的，可以算出总共的方案加上等于的方案再除以二。</p>\n<p>考虑等于的方案，可把每个质因数分开考虑，相当于做背包取第 $0$ 项；</p>\n<p>考虑总共的方案，对于在 $a_i$ 中出现了 $k$ 次的质因数 $x$，贡献为 $\\frac 1 2 (k + 1) (k + 2)$。</p>\n<pre><code class=\"language-cpp\">// =================================\n//   author: memset0\n//   date: 2019.07.07 11:14:03\n//   website: https://memset0.cn/\n// =================================\n#include &#x3C;bits/stdc++.h>\n#define ll long long\n#define debug(...) ((void)0)\n#ifndef debug\n#define debug(...) fprintf(stderr,__VA_ARGS__)\n#endif\nnamespace ringo {\ntemplate &#x3C;class T> inline void read(T &#x26;x) {\n\tx = 0; char c = getchar(); bool f = 0;\n\twhile (!isdigit(c)) f ^= c == '-', c = getchar();\n\twhile (isdigit(c)) x = x * 10 + c - '0', c = getchar();\n\tif (f) x = -x;\n}\ntemplate &#x3C;class T> inline void print(T x) {\n\tif (x &#x3C; 0) putchar('-'), x = -x;\n\tif (x > 9) print(x / 10);\n\tputchar('0' + x % 10);\n}\ntemplate &#x3C;class T> inline void print(T x, char c) { print(x), putchar(c); }\ntemplate &#x3C;class T> inline void print(T a, int l, int r, std::string s = \"\") {\n\tif (s != \"\") std::cout &#x3C;&#x3C; s &#x3C;&#x3C; \": \";\n\tfor (int i = l; i &#x3C;= r; i++) print(a[i], \" \\n\"[i == r]);\n}\n\nconst int N = 110, M = 1e5 + 10, mod = 998244353;\nint n, min, max, ans = 1, sum = 1, pcnt;\nint a[N], b[N][M], c[M][N], pri[M], vis[M], f[M], g[M];\n\ninline int dec(int a, int b) { a -= b; return a &#x3C; 0 ? a + mod : a; }\ninline int inc(int a, int b) { a += b; return a >= mod ? a - mod : a; }\ninline int mul(int a, int b) { return (ll)a * b - (ll)a * b / mod * mod; }\n\nvoid init_pri(int limit) {\n\tfor (int i = 2; i &#x3C; limit; i++) {\n\t\tif (!vis[i]) pri[++pcnt] = i;\n\t\tfor (int j = 1; j &#x3C;= pcnt &#x26;&#x26; i * pri[j] &#x3C; limit; j++)\n\t\t\t{ vis[i * pri[j]] = 1; if (i % pri[j] == 0) break; }\n\t}\n}\n\nvoid split(int x, int *cnt) {\n\tstatic std::map&#x3C;int, int> map;\n\tfor (int i = 1; i &#x3C;= pcnt; i++) while (x % pri[i] == 0) ++cnt[i], x /= pri[i];\n\tif (x != 1) ++cnt[map.find(x) == map.end() ? (pri[++pcnt] = x, map[x] = pcnt) : map[x]];\n}\n\nint solve(int *cnt) {\n\tfor (register int i = min; i &#x3C;= max; i++) f[i] = 0;\n\tmin = max = 0, f[0] = 1;\n\tfor (int i = 1; i &#x3C;= n; i++) {\n\t\tfor (int j = 0; j &#x3C;= cnt[i]; j++)\n\t\t\tfor (int k = 0; k &#x3C;= j; k++)\n\t\t\t\tfor (int i = min; i &#x3C;= max; i++)\n\t\t\t\t\tg[i + (k &#x3C;&#x3C; 1) - j] = inc(g[i + (k &#x3C;&#x3C; 1) - j], f[i]);\n\t\tmin -= cnt[i], max += cnt[i];\n\t\tfor (register int i = min; i &#x3C;= max; i++) f[i] = g[i], g[i] = 0;\n\t}\n\treturn f[0];\n}\n\nvoid main() {\n\tread(n), init_pri(1e5);\n\tfor (int i = 1; i &#x3C;= n; i++) read(a[i]), split(a[i], b[i]);\n\tfor (int i = 1; i &#x3C;= n; i++) for (int j = 1; j &#x3C;= pcnt; j++) c[j][i] = b[i][j];\n\tfor (int i = 1; i &#x3C;= pcnt; i++) ans = mul(ans, solve(c[i]));\n\tfor (int i = 1; i &#x3C;= pcnt; i++) for (int j = 1; j &#x3C;= n; j++) sum = mul(sum, mul((mod + 1) >> 1, mul(c[i][j] + 2, c[i][j] + 1)));\n\tprint(mul(inc(ans, sum), (mod + 1) >> 1), '\\n');\n}\n\n} signed main() {\n#ifdef MEMSET0_LOCAL_ENVIRONMENT\n\tfreopen(\"1.in\", \"r\", stdin);\n#endif\n\treturn ringo::main(), 0;\n}\n</code></pre>","frontmatter":{"date":"July 07, 2019","title":"「CTT2018」esperar","cover":"/cover/3.png"}}},"pageContext":{"id":"780999b5-79ac-52cb-8cab-96ce6888a69c","slug":"blog/problem/ctt2018-esperar"}},"staticQueryHashes":[],"slicesMap":{}}