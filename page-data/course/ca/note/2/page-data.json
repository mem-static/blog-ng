{"componentChunkName":"component---src-templates-post-js","path":"/course/ca/note/2/","result":{"data":{"site":{"siteMetadata":{"title":"mem 的小站"}},"post":{"id":"91f1d1ef-e8d1-5cf9-be4f-3a02064a57f2","excerpt":"1. Introduction to Memory Hierarchy 随机存取存储器(random access memory, RAM) 静态随机存取存储器(static RAM, SRAM)：快、贵、数据\"永久\"保留直到断电． 动态随机存取存储器(dynamic RAM, DRAM…","html":"<style>\n    :root {\n        --slide-width: 1254;\n        --slide-height: 706;\n    }\n    .slide2x {\n        width: 100%;\n        display: flex;\n        border: 1px solid black;\n        margin-left: auto;\n        margin-right: auto;\n        overflow: hidden;\n        border-radius: 6px;\n    }\n    .slide2x .slide1x {\n        width: 50%;\n        height: auto;\n        aspect-ratio: calc(var(--slide-width)) / calc(var(--slide-height) * (1 - var(--crop-top) - var(--crop-bottom)));\n        overflow: hidden;\n        position: relative;\n    }\n    .slide2x .slide1x img {\n        position: absolute;\n        top: calc(100% * var(--crop-top));\n        left: 0;\n        width: 100%;\n        height: auto;\n    }\n    </style>\n<h2 id=\"anchor-6c91fa7576d9d8e4\" style=\"position: relative;\"><a href=\"#anchor-6c91fa7576d9d8e4\" aria-label=\"anchor 6c91fa7576d9d8e4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Introduction to Memory Hierarchy</h2>\n<ul>\n<li>\n<p><strong>随机存取存储器(random access memory, RAM)</strong></p>\n<ul>\n<li>\n<p><strong>静态随机存取存储器(static RAM, SRAM)</strong>：快、贵、数据\"永久\"保留直到断电．</p>\n</li>\n<li>\n<p><strong>动态随机存取存储器(dynamic RAM, DRAM)</strong>：慢、便宜、需要定期\"刷新\"．</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>局部性原则(principle of locality)</strong></p>\n<ul>\n<li>\n<p><strong>时间局部性(temporal locality)</strong>：最近被访问过的数据可能在不久之后会被再次访问．</p>\n</li>\n<li>\n<p><strong>空间局部性(spatial locality)</strong>：被访问过的数据的邻近数据在不久之后很可能被访问．</p>\n</li>\n</ul>\n</li>\n</ul>\n<p><details open class=\"callout callout-type-quote\"><summary style=\"pointer-events: none;\"> 内存层次结构</summary><div class=\"callout-content\"><p></p><img src=\"https://course.cdn.memset0.cn/ca/notes/images/2025-03-31-20-35-33.png\" style=\"width: calc(0.56 * 50em)\"></div></details></p>\n<p><details open class=\"callout callout-type-example\"><summary style=\"pointer-events: none;\"> 回顾：和 cache 相关的概念与名词</summary><div class=\"callout-content\"><p></p><img src=\"https://course.cdn.memset0.cn/ca/public/merged-2-1/0013.jpg\" style=\"width: calc(0.6 * 50em)\"></div></details></p>\n<h2 id=\"anchor-e1a3a6d0e1ba00f9\" style=\"position: relative;\"><a href=\"#anchor-e1a3a6d0e1ba00f9\" aria-label=\"anchor e1a3a6d0e1ba00f9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Four Questions for Memory Hierarchy Designers</h2>\n<ul>\n<li>\n<p><strong>内存设计者需要回答的四个问题</strong>：</p>\n<ul>\n<li>\n<p>Q1: Where can a block be placed in the upper level/main memory? (Block placement)</p>\n</li>\n<li>\n<p>Q2: How is a block found if it is in the upper level/main memory? (Block identification)</p>\n</li>\n<li>\n<p>Q3: Which block should be replaced on a Cache/main memory miss? (Block replacement)</p>\n</li>\n<li>\n<p>Q4: What happens on a write? (Write strategy)</p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"anchor-cdd7c64c01b889fe\" style=\"position: relative;\"><a href=\"#anchor-cdd7c64c01b889fe\" aria-label=\"anchor cdd7c64c01b889fe permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.1. Block Placement | 块的存放位置</h3>\n<ul>\n<li>\n<p><strong>直接映射(direct mapped)</strong>：块只能放在缓存中的一个位置．</p>\n</li>\n<li>\n<p><strong>全相联(fully associative)</strong>：块可以放在缓存中的任意位置．</p>\n</li>\n<li>\n<p><strong>组相联(set associative)</strong>：块可以在一个组里的任意位置，组里可以有若干块．</p>\n<ul>\n<li>如果组中有 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> 个块，则称为 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>-路组相联．一般来说，<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">n \\leq 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span></span>．</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"anchor-cccb136d65a28073\" style=\"position: relative;\"><a href=\"#anchor-cccb136d65a28073\" aria-label=\"anchor cccb136d65a28073 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.2. Block Identification | 块的标识</h3>\n<ul>\n<li>\n<p><strong>块的组成部分</strong>：</p>\n<ul>\n<li>\n<p><strong>标签(tag)</strong>：可用于辨别某个块是否是所需要的，这个搜索过程一般是并行执行的．</p>\n<ul>\n<li>需要的 tag 位数 = 地址位数 - index 位数 - block offset 位数</li>\n</ul>\n</li>\n<li>\n<p><strong>索引(index)</strong>：在直接映射/组相联中用于选择具体的块/组（在全相联中就不需要）．</p>\n</li>\n<li>\n<p><strong>块偏移(block offset)</strong>：用于在一个块中选择具体数据（定位到具体字节），不包含在块地址中．</p>\n</li>\n</ul>\n</li>\n</ul>\n<img src=\"https://course.cdn.memset0.cn/ca/notes/images/2025-03-31-20-41-39.png\" style=\"width: calc(0.4 * 50em)\">\n<h3 id=\"anchor-1dfd9086801fbc30\" style=\"position: relative;\"><a href=\"#anchor-1dfd9086801fbc30\" aria-label=\"anchor 1dfd9086801fbc30 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.3. Block Replacement | 块的替换</h3>\n<ul>\n<li>\n<p><strong>随机替换(random replacement)</strong>：随机选择一个cache中的块并进行替换．</p>\n<ul>\n<li>实现简单．也可以用一些伪随机数算法实现．</li>\n</ul>\n</li>\n<li>\n<p><strong>最近最少使用(Least-Recently Used, LRU)</strong>：替换最近没有使用过的块——<mark>需要额外的位数来记录访问时间</mark>．</p>\n<ul>\n<li>存在近似策略——使用 ref bit．</li>\n</ul>\n</li>\n<li>\n<p><strong>先进先出(First-In-First-Out, FIFO)</strong>：选择最早进入cache的块进行替换．</p>\n<ul>\n<li>算是一种 LRU 的近似策略．</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"anchor-d8fd507dcf90e7cd\" style=\"position: relative;\"><a href=\"#anchor-d8fd507dcf90e7cd\" aria-label=\"anchor d8fd507dcf90e7cd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.4. Write Strategy | 写入策略</h3>\n<ul>\n<li>\n<p>write through V.S. write back</p>\n<ul>\n<li>\n<p><strong>写穿(write through)</strong>：同时写入 cache 和下一级内存中．</p>\n<ul>\n<li>\n<p>优点：实现简单，<strong>数据一致性(data coherency)</strong> 好．</p>\n</li>\n<li>\n<p>缺点：CPU 必须等待下一级内存写入完成才能执行下一步，称为 <strong>写停顿(write stall)</strong>．</p>\n<ul>\n<li>\n<p>可以引入 <strong>写缓冲(write buffer)</strong> 来缓解这个问题．</p>\n</li>\n<li>\n<p>可以引入二级缓存（L2）来进一步缓解写缓冲区也容易饱和的问题．</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>写回(write back)</strong>：只写入到 cache 的块中，但是如果这个块要被移除 cache 则将数据写入到下一级内存中．</p>\n<ul>\n<li>\n<p>优点：速度快、使用<mark>更少的内存带宽</mark>．</p>\n</li>\n<li>\n<p>需要引入一个 <strong>脏位(dirty bit)</strong> 来标记块是否有被修改过．</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>块未命中时（write miss）的写入策略</p>\n<ul>\n<li>\n<p><strong>写分配(write allocate)</strong>（对应 write back 策略）：当cache未命中时，先从下一级内存把块加载到 cache中．</p>\n</li>\n<li>\n<p><strong>非写分配(no-write allocate, write around)</strong>（对应 write through 策略）：不让 write miss 影响到 cache，而是直接写入到下一级内存中．</p>\n</li>\n</ul>\n</li>\n</ul>\n<p>?</p>\n<h2 id=\"anchor-c67e8e7f4bc0cb5a\" style=\"position: relative;\"><a href=\"#anchor-c67e8e7f4bc0cb5a\" aria-label=\"anchor c67e8e7f4bc0cb5a permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Cache Performance Measures | 缓存性能指标</h2>\n<h3 id=\"anchor-a60c2ade0b40ceaa\" style=\"position: relative;\"><a href=\"#anchor-a60c2ade0b40ceaa\" aria-label=\"anchor a60c2ade0b40ceaa permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1. CPU Execution Time | CPU 执行时间</h3>\n<ul>\n<li><strong>CPU 执行时间</strong>（考虑 cache miss 导致的 memory stall）：</li>\n</ul>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> CPU Time </mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mtext>CPU Clock Cycles </mtext><mo>+</mo><mtext> Memory Stall Cycles</mtext><mo fence=\"true\">)</mo></mrow><mo>×</mo><mtext> Clock Cycle Time </mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mtext> IC </mtext><mo>×</mo><mrow><mo fence=\"true\">(</mo><mtext>CPI </mtext><mo>+</mo><mfrac><mtext> Mem Accesses </mtext><mtext> Inst </mtext></mfrac><mo>×</mo><mtext> Miss Rate </mtext><mo>×</mo><mtext> Miss Penalty</mtext><mo fence=\"true\">)</mo></mrow><mo>×</mo><mtext> Clock Cycle Time </mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mtext> IC </mtext><mo>×</mo><mrow><mo fence=\"true\">(</mo><mtext>CPI </mtext><mo>+</mo><mfrac><mtext> Mem Misses </mtext><mtext> Inst </mtext></mfrac><mo>×</mo><mtext> Miss Penalty</mtext><mo fence=\"true\">)</mo></mrow><mo>×</mo><mtext> Clock Cycle Time </mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n\\text{ CPU Time } &#x26; = \\left( \\text{CPU Clock Cycles } + \\text{ Memory Stall Cycles} \\right) \\times \\text{ Clock Cycle Time } \\\\\n &#x26; = \\text{ IC } \\times \\left( \\text{CPI } + \\frac{\\text{ Mem Accesses }}{\\text{ Inst }} \\times \\text{ Miss Rate } \\times \\text{ Miss Penalty} \\right) \\times \\text{ Clock Cycle Time } \\\\\n &#x26; = \\text{ IC } \\times \\left( \\text{CPI } + \\frac{\\text{ Mem Misses }}{\\text{ Inst }} \\times \\text{ Miss Penalty} \\right) \\times \\text{ Clock Cycle Time }\n\\end{aligned}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:6.9001em;vertical-align:-3.2em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7em;\"><span style=\"top:-6.31em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> CPU Time </span></span></span></span><span style=\"top:-4.2em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.5em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7em;\"><span style=\"top:-6.31em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord text\"><span class=\"mord\">CPU Clock Cycles </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Memory Stall Cycles</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Clock Cycle Time </span></span></span></span><span style=\"top:-4.2em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord text\"><span class=\"mord\"> IC </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord text\"><span class=\"mord\">CPI </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> Inst </span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> Mem Accesses </span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Miss Rate </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Miss Penalty</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Clock Cycle Time </span></span></span></span><span style=\"top:-1.5em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord text\"><span class=\"mord\"> IC </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord text\"><span class=\"mord\">CPI </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> Inst </span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> Mem Misses </span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Miss Penalty</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Clock Cycle Time </span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2em;\"><span></span></span></span></span></span></span></span></span></span></span></span></div>\n<h3 id=\"anchor-82d2bc8a6e0cca8e\" style=\"position: relative;\"><a href=\"#anchor-82d2bc8a6e0cca8e\" aria-label=\"anchor 82d2bc8a6e0cca8e permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.2. Average Memory Access Time | 平均内存访问时间</h3>\n<ul>\n<li><strong>平均内存访问时间(average memory access time, AMAT)</strong>：</li>\n</ul>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext> AMAT </mtext><mo>=</mo><mtext> HitTime </mtext><mo>+</mo><mrow><mo fence=\"true\">(</mo><mtext>Miss Rate </mtext><mo>×</mo><mtext> Miss Penalty</mtext><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{ AMAT } = \\text{ HitTime } + \\left( \\text{Miss Rate } \\times \\text{ Miss Penalty} \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\"> AMAT </span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\"> HitTime </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord text\"><span class=\"mord\">Miss Rate </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> Miss Penalty</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span></span></div>\n<ul>\n<li>分开考虑 Inst. &#x26; Data 内存的情况：</li>\n</ul>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext> AMAT </mtext><mo>=</mo><mrow><mo fence=\"true\">(</mo><msub><mtext>HitTime</mtext><mtext>inst </mtext></msub><mo>+</mo><msub><mtext> MissRate</mtext><mtext>inst </mtext></msub><mo>×</mo><msub><mtext> MissPenalty</mtext><mtext>inst</mtext></msub><mo fence=\"true\">)</mo></mrow><mo>+</mo><mrow><mo fence=\"true\">(</mo><msub><mtext>HitTime</mtext><mtext>data </mtext></msub><mo>+</mo><msub><mtext> MissRate</mtext><mtext>data </mtext></msub><mo>×</mo><msub><mtext> MissPenalty</mtext><mtext>data</mtext></msub><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{ AMAT } = \\left( \\text{HitTime}_{\\text{inst }} + \\text{ MissRate}_{\\text{inst }} \\times \\text{ MissPenalty}_{\\text{inst}} \\right) + \\left( \\text{HitTime}_{\\text{data }} + \\text{ MissRate}_{\\text{data }} \\times \\text{ MissPenalty}_{\\text{data}} \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\"> AMAT </span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">HitTime</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">inst </span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> MissRate</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">inst </span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> MissPenalty</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2234em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">inst</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">(</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">HitTime</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">data </span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> MissRate</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">data </span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> MissPenalty</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.242em;\"><span style=\"top:-2.4559em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">data</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2441em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\">)</span></span></span></span></span></span></div>\n<ul>\n<li>将AMAT应用到CPU Time的计算中（将指令分成 ALU 指令和内存访问相关指令两个部分）：</li>\n</ul>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext> CPU Time </mtext><mo>=</mo><mtext> IC </mtext><mo>×</mo><mrow><mo fence=\"true\">(</mo><mfrac><mtext>ALUOps </mtext><mtext> Inst </mtext></mfrac><mo>×</mo><msub><mtext> CPU</mtext><mtext>ALUOps </mtext></msub><mo>+</mo><mfrac><mtext> MemAccess </mtext><mtext> Inst </mtext></mfrac><mo>×</mo><mtext> AMAT</mtext><mo fence=\"true\">)</mo></mrow><mo>×</mo><mtext> Clock Cycle Time </mtext></mrow><annotation encoding=\"application/x-tex\">\\text{ CPU Time } = \\text{ IC } \\times \\left( \\frac{\\text{ALUOps }}{\\text{ Inst }} \\times \\text{ CPU}_{\\text{ALUOps }} + \\frac{\\text{ MemAccess }}{\\text{ Inst }} \\times \\text{ AMAT} \\right) \\times \\text{ Clock Cycle Time }</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord text\"><span class=\"mord\"> CPU Time </span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord text\"><span class=\"mord\"> IC </span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> Inst </span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">ALUOps </span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> CPU</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">ALUOps </span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> Inst </span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> MemAccess </span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\"> AMAT</span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\"> Clock Cycle Time </span></span></span></span></span></span></div>\n<h2 id=\"anchor-7e579eb010e0680f\" style=\"position: relative;\"><a href=\"#anchor-7e579eb010e0680f\" aria-label=\"anchor 7e579eb010e0680f permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Improve DRAM Performance</h2>\n<h2 id=\"anchor-94e552ad18fdc4cd\" style=\"position: relative;\"><a href=\"#anchor-94e552ad18fdc4cd\" aria-label=\"anchor 94e552ad18fdc4cd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Improve Cache Performance | 提升缓存性能</h2>\n<ul>\n<li>如何提升 cache 的性能？就是降低 AMAT．可以从 AMAT 的计算公式入手考虑．</li>\n</ul>\n<p><details open class=\"callout callout-type-tip\"><summary style=\"pointer-events: none;\"> Tip</summary><div class=\"callout-content\"><p></p><img src=\"https://course.cdn.memset0.cn/ca/notes/images/2025-03-31-22-21-32.png\" style=\"width: calc(0.8 * 50em)\"></div></details></p>\n<h3 id=\"anchor-afcee8d5afea314d\" style=\"position: relative;\"><a href=\"#anchor-afcee8d5afea314d\" aria-label=\"anchor afcee8d5afea314d permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1. Reduce Hit Time | 减少命中时间</h3>\n<h4 id=\"anchor-5366c6eaee07299b\" style=\"position: relative;\"><a href=\"#anchor-5366c6eaee07299b\" aria-label=\"anchor 5366c6eaee07299b permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1.1. Small and Simple Caches | 使用小且简单的缓存</h4>\n<ul>\n<li>\n<p><strong>方法</strong>：使用小型、直接映射的cache；因为结构越简单就意味着hit时速度越快，直接映射不需要组内查找．</p>\n</li>\n<li>\n<p><strong>优点</strong>：简化结构 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>⇒</mo></mrow><annotation encoding=\"application/x-tex\">\\Rightarrow</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">⇒</span></span></span></span></span> 减少 hit time；减少功耗．</p>\n</li>\n<li>\n<p><strong>缺点</strong>：增加 miss rate．</p>\n</li>\n<li>\n<p><strong>结论</strong>：广泛使用，一般用在 L1 cache．</p>\n</li>\n</ul>\n<h4 id=\"anchor-65fb03fa583b1cfd\" style=\"position: relative;\"><a href=\"#anchor-65fb03fa583b1cfd\" aria-label=\"anchor 65fb03fa583b1cfd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1.2. Way Prediction | 路预测</h4>\n<ul>\n<li>\n<p><strong>方法</strong>：<strong>路预测(way-prediction)</strong> 通过在cache中保留额外的位（称为 predictor bit）来\"预测\"<mark>每个组中访问的路</mark>．实际上 predictor bit 存储的就是该组上一次访问的路．</p>\n<ul>\n<li>\n<p>如果hit，只需要一个时钟周期，因为不需要进行查找．</p>\n</li>\n<li>\n<p>如果miss，更新predictor bit并继续判断，这会带来一个额外的时钟周期，直到最终hit．</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>优点</strong>：减少 hit time；减少功耗．</p>\n</li>\n<li>\n<p><strong>缺点</strong>：加大了实现流水线化 cache 的难度．</p>\n</li>\n</ul>\n<h4 id=\"anchor-f9d39c011e8272f9\" style=\"position: relative;\"><a href=\"#anchor-f9d39c011e8272f9\" aria-label=\"anchor f9d39c011e8272f9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1.3. Avoiding Address Translation during Indexing</h4>\n<ul>\n<li>\n<p><strong>问题</strong>：在计算机中尝尝需要使用虚拟地址来访问内存，然而 <mark>cache 是基于物理地址的</mark>，需要page table进行转换——相当于每次访问都需要进行两次内存操作．</p>\n</li>\n<li>\n<p>方法一：使用虚拟地址来索引 cache（virtuall addressed cache）？</p>\n<ul>\n<li>会导致 <strong>同义词问题(synonym problem)</strong>：两个虚拟地址可能映射到同一物理地址，从而导致同一个物理块在 cache 中有多个副本．进而导致数据不一致问题．</li>\n</ul>\n</li>\n<li>\n<p>方法二：使用计组中讲到过的 TLB．</p>\n</li>\n</ul>\n<h4 id=\"anchor-7442d5e76cadf1d8\" style=\"position: relative;\"><a href=\"#anchor-7442d5e76cadf1d8\" aria-label=\"anchor 7442d5e76cadf1d8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1.4. Trace Caches</h4>\n<h3 id=\"anchor-2aa8a37b5d9e80bb\" style=\"position: relative;\"><a href=\"#anchor-2aa8a37b5d9e80bb\" aria-label=\"anchor 2aa8a37b5d9e80bb permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.2. Increase Bandwidth</h3>\n<h4 id=\"anchor-71cebbdd730d1ac7\" style=\"position: relative;\"><a href=\"#anchor-71cebbdd730d1ac7\" aria-label=\"anchor 71cebbdd730d1ac7 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.2.1. Pipelined Caches</h4>\n<h4 id=\"anchor-c47810e4dcad0967\" style=\"position: relative;\"><a href=\"#anchor-c47810e4dcad0967\" aria-label=\"anchor c47810e4dcad0967 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.2.2. Multibanked Caches</h4>\n<h4 id=\"anchor-78a7375e5c1d2ab4\" style=\"position: relative;\"><a href=\"#anchor-78a7375e5c1d2ab4\" aria-label=\"anchor 78a7375e5c1d2ab4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.2.3. Nonblocking Caches</h4>\n<h3 id=\"anchor-ad99adde927c7d65\" style=\"position: relative;\"><a href=\"#anchor-ad99adde927c7d65\" aria-label=\"anchor ad99adde927c7d65 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.3. Reduce Miss Penalty</h3>\n<h4 id=\"anchor-ac0d49f29eb806a6\" style=\"position: relative;\"><a href=\"#anchor-ac0d49f29eb806a6\" aria-label=\"anchor ac0d49f29eb806a6 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.3.1. Multi-level Caches</h4>\n<h4 id=\"anchor-9578507f61e03401\" style=\"position: relative;\"><a href=\"#anchor-9578507f61e03401\" aria-label=\"anchor 9578507f61e03401 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.3.2. Giving Priority to Read Misses over Writes</h4>\n<h4 id=\"anchor-7885ec03fff749d1\" style=\"position: relative;\"><a href=\"#anchor-7885ec03fff749d1\" aria-label=\"anchor 7885ec03fff749d1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.3.3. Critical Word First &#x26; Early Restart</h4>\n<h4 id=\"anchor-ea5357fec1591f9d\" style=\"position: relative;\"><a href=\"#anchor-ea5357fec1591f9d\" aria-label=\"anchor ea5357fec1591f9d permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.3.4. Merging Write Buffer</h4>\n<h4 id=\"anchor-d8918e37916562c5\" style=\"position: relative;\"><a href=\"#anchor-d8918e37916562c5\" aria-label=\"anchor d8918e37916562c5 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.3.5. Victim Caches | 受害者缓存</h4>\n<h3 id=\"anchor-511f31fa907c82b4\" style=\"position: relative;\"><a href=\"#anchor-511f31fa907c82b4\" aria-label=\"anchor 511f31fa907c82b4 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.4. Reduce Miss Rate</h3>\n<ul>\n<li>\n<p>cache miss 的来源：</p>\n<ul>\n<li>\n<p><strong>强制(compulsory)</strong>（也称为 <strong>冷启动失效 (cold-start misses)</strong>）：在一开始访问cache必定出现miss，因为块必须先被加载到cache中．</p>\n</li>\n<li>\n<p><strong>容量(capacity)</strong>：在程序执行的过程中，cache无法包含所有需要的块，于是不得不抛弃一些块，但之后可能又需要这些块，从而发生miss．</p>\n<ul>\n<li>除非增大cache容量，否则这一问题无法解决（不在本小节的讨论范围内）．</li>\n</ul>\n</li>\n<li>\n<p><strong>冲突(conflict)</strong>：对于组相联 / 直接映射而言，由于多个数据块映射到相同的组上，导致较早存入的数据被替换，导致后续又需要时发生miss．</p>\n</li>\n<li>\n<p><strong>一致性(coherency)</strong>：针对多核处理器导致的cache一致性缺失，不在目前的讨论范围内．</p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"anchor-5edf0077e5ebadd8\" style=\"position: relative;\"><a href=\"#anchor-5edf0077e5ebadd8\" aria-label=\"anchor 5edf0077e5ebadd8 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.4.1. Larger Block Size | 增加块大小</h4>\n<ul>\n<li>\n<p><strong>优点</strong>：减少 compulsory miss．</p>\n</li>\n<li>\n<p><strong>缺点</strong>：</p>\n<ul>\n<li>\n<p>增加 miss penalty．</p>\n</li>\n<li>\n<p>增加 conflict miss．</p>\n</li>\n<li>\n<p>增加 capacity miss，特别是对于小 cache．</p>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>结论</strong>：优化曲线呈 U 形，存在 trade-off．</p>\n</li>\n</ul>\n<img src=\"https://course.cdn.memset0.cn/ca/notes/images/2025-03-31-21-54-21.png\" style=\"width: calc(0.48 * 50em)\">\n<h4 id=\"anchor-9f004010c9806394\" style=\"position: relative;\"><a href=\"#anchor-9f004010c9806394\" aria-label=\"anchor 9f004010c9806394 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.4.2. Larger Caches | 增加缓存大小</h4>\n<ul>\n<li>\n<p><strong>优点</strong>：减少 capacity miss．</p>\n</li>\n<li>\n<p><strong>缺点</strong>:</p>\n<ul>\n<li>\n<p>增加 hit time．</p>\n</li>\n<li>\n<p>增加成本和功率．</p>\n</li>\n</ul>\n</li>\n<li>\n<p>在芯片高速缓存的优化中一般不考虑这种方法．</p>\n</li>\n</ul>\n<h4 id=\"anchor-af26098069b5796d\" style=\"position: relative;\"><a href=\"#anchor-af26098069b5796d\" aria-label=\"anchor af26098069b5796d permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.4.3. Higher Associativity | 增加相联度</h4>\n<ul>\n<li>\n<p><strong>方法</strong>：就是增加\"<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span> 路组相联\"里的 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>．</p>\n</li>\n<li>\n<p><strong>优点</strong>：减少 miss rate，<mark>但也取决于具体的访问序列</mark>．</p>\n</li>\n<li>\n<p><strong>缺点</strong>：增加 hit time．</p>\n</li>\n<li>\n<p><strong>经验</strong>：8路组相联降低miss rate的效果近乎等价于全相联——再提高相联度的效果不明显．</p>\n</li>\n<li>\n<p><strong>结论</strong>：对于clock rate较高的情况下，不建议提升相联度；但在miss penalty较大的情况下，可以考虑提升相联度．</p>\n</li>\n</ul>\n<h4 id=\"anchor-4e884f05d0283b69\" style=\"position: relative;\"><a href=\"#anchor-4e884f05d0283b69\" aria-label=\"anchor 4e884f05d0283b69 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.4.4. Compiler Optimizations</h4>\n<h4 id=\"anchor-594019b471b98eac\" style=\"position: relative;\"><a href=\"#anchor-594019b471b98eac\" aria-label=\"anchor 594019b471b98eac permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.4.5. Way Prediction and Pseudo-Associative Cache</h4>\n<h3 id=\"anchor-8b56f16b62f5f4ea\" style=\"position: relative;\"><a href=\"#anchor-8b56f16b62f5f4ea\" aria-label=\"anchor 8b56f16b62f5f4ea permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.5. Reduce Miss Penalty/Rate via Parallelization</h3>\n<h4 id=\"anchor-b3826725582040d9\" style=\"position: relative;\"><a href=\"#anchor-b3826725582040d9\" aria-label=\"anchor b3826725582040d9 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.5.1. Hardware Prefetching of Inst. and Data | 硬件预取</h4>\n<h4 id=\"anchor-9bb2bcf6d959a63d\" style=\"position: relative;\"><a href=\"#anchor-9bb2bcf6d959a63d\" aria-label=\"anchor 9bb2bcf6d959a63d permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.5.2. Compiler-controlled Prefetch | 编译器控制的预取</h4>\n<h3 id=\"anchor-c9a5b747b7c0dab3\" style=\"position: relative;\"><a href=\"#anchor-c9a5b747b7c0dab3\" aria-label=\"anchor c9a5b747b7c0dab3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.6. Using HBM to extend the memory hierarchy</h3>\n<p><details open class=\"callout callout-type-note\"><summary style=\"pointer-events: none;\"> cache 流程总结</summary><div class=\"callout-content\"><p></p><img src=\"https://course.cdn.memset0.cn/ca/notes/images/2025-03-31-22-19-56.png\" style=\"width: calc(0.5 * 50em)\"></div></details></p>\n<h2 id=\"anchor-ad145f8c66559234\" style=\"position: relative;\"><a href=\"#anchor-ad145f8c66559234\" aria-label=\"anchor ad145f8c66559234 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Virtual Memory</h2>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#anchor-6c91fa7576d9d8e4\">1. Introduction to Memory Hierarchy</a></p>\n</li>\n<li>\n<p><a href=\"#anchor-e1a3a6d0e1ba00f9\">2. Four Questions for Memory Hierarchy Designers</a></p>\n<ul>\n<li><a href=\"#anchor-cdd7c64c01b889fe\">2.1. Block Placement | 块的存放位置</a></li>\n<li><a href=\"#anchor-cccb136d65a28073\">2.2. Block Identification | 块的标识</a></li>\n<li><a href=\"#anchor-1dfd9086801fbc30\">2.3. Block Replacement | 块的替换</a></li>\n<li><a href=\"#anchor-d8fd507dcf90e7cd\">2.4. Write Strategy | 写入策略</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#anchor-c67e8e7f4bc0cb5a\">3. Cache Performance Measures | 缓存性能指标</a></p>\n<ul>\n<li><a href=\"#anchor-a60c2ade0b40ceaa\">3.1. CPU Execution Time | CPU 执行时间</a></li>\n<li><a href=\"#anchor-82d2bc8a6e0cca8e\">3.2. Average Memory Access Time | 平均内存访问时间</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#anchor-7e579eb010e0680f\">4. Improve DRAM Performance</a></p>\n</li>\n<li>\n<p><a href=\"#anchor-94e552ad18fdc4cd\">5. Improve Cache Performance | 提升缓存性能</a></p>\n<ul>\n<li><a href=\"#anchor-afcee8d5afea314d\">5.1. Reduce Hit Time | 减少命中时间</a></li>\n<li><a href=\"#anchor-2aa8a37b5d9e80bb\">5.2. Increase Bandwidth</a></li>\n<li><a href=\"#anchor-ad99adde927c7d65\">5.3. Reduce Miss Penalty</a></li>\n<li><a href=\"#anchor-511f31fa907c82b4\">5.4. Reduce Miss Rate</a></li>\n<li><a href=\"#anchor-8b56f16b62f5f4ea\">5.5. Reduce Miss Penalty/Rate via Parallelization</a></li>\n<li><a href=\"#anchor-c9a5b747b7c0dab3\">5.6. Using HBM to extend the memory hierarchy</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#anchor-ad145f8c66559234\">6. Virtual Memory</a></p>\n</li>\n</ul>","frontmatter":{"title":"II. Memory Hierarchy","description":null},"fields":{"cover":null,"slug":"/course/ca/note/2/","cssclasses":null,"isDoc":true,"authors":[],"createTime":"2025 年 3 月 31 日","updateTime":"2025 年 4 月 1 日","category":"[{\"name\":\"课程笔记\",\"to\":\"/course/\"}]","propsJson":null}},"previous":null,"next":null},"pageContext":{"id":"91f1d1ef-e8d1-5cf9-be4f-3a02064a57f2","previousPostId":null,"nextPostId":null,"navJson":"[{\"slug\":\"/course\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/index.md\",\"title\":\"导航\"},{\"title\":\"通识课程\",\"children\":[{\"slug\":\"/course/calculus\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/calculus/index.md\",\"title\":\"微积分\"},{\"slug\":\"/course/linear-algebra\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/linear-algebra/index.md\",\"title\":\"线性代数\"},{\"slug\":\"/course/physics\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/physics/index.md\",\"title\":\"工程物理学\"}]},{\"title\":\"专业必修课程\",\"children\":[{\"slug\":\"/course/dm\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/dm/index.md\",\"title\":\"离散数学及其应用\"},{\"slug\":\"/course/ptms\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/ptms/index.md\",\"title\":\"概率论与数理统计\"},{\"slug\":\"/course/ads\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/ads/index.md\",\"title\":\"高级数据结构\"},{\"slug\":\"/course/dd\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/dd/index.md\",\"title\":\"数字逻辑设计\"},{\"slug\":\"/course/co\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/co/index.md\",\"title\":\"计算机组成\"}]},{\"title\":\"专业选修课程\",\"children\":[{\"slug\":\"/course/java\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/java/index.md\",\"title\":\"Java 应用技术\"}]},{\"title\":\"个性修读课程\",\"children\":[{\"slug\":\"/course/fasm\",\"file\":\"/home/runner/work/gatsby-blog/gatsby-blog/content/course/fasm/index.md\",\"title\":\"汇编程序设计基础\"}]}]"}},"staticQueryHashes":["3871233186"],"slicesMap":{}}